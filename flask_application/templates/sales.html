<!DOCTYPE html>
<html>
<head>
    <title>Superstore Sales Analysis</title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        *{box-sizing: border-box;}

        .header {
            overflow: hidden;
            background-color: #f1f1f1;
            padding: 20px 10px;
        }

        .header a {
            float: left;
            color: black;
            text-align: center;
            padding: 12px;
            text-decoration: none;
            font-size: 18px; 
            line-height: 25px;
            border-radius: 4px;
        }

        .header a.logo {
            font-size: 25px;
            font-weight: bold;
        }

        .header a:hover {
            background-color: #ddd;
            color: black;
        }

        .header a.active {
            background-color: dodgerblue;
            color: white;
        }

        .header-right {
            float: right;
        }

        @media screen and (max-width: 500px) {
        .header a {
            float: none;
            display: block;
            text-align: left;
        }
        
        .header-right {
            float: none;
        }
        
        }
        
        body {
            /* display: grid; */
            grid-template-columns: repeat(2, 1fr);
            grid-gap: 10px;
            padding: 0;
            background-size: cover;
            background-repeat: no-repeat;
            font-family: Arial, sans-serif;
        }
        /* CSS for styling the graph containers */
        .chart-container {
            border: 4px solid rgb(43, 177, 126);
            border-radius: 10px;
            margin: 10px;
            padding: 10px;
        }

        #nav-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="header">
        <a href="#default" class="logo">Superstore Sales Analysis</a>
        <div class="header-right">
          <a  href="/">Home</a>
          <a class="active" href="#sales">Sales Dashboard</a>
          <a href="/datadisplay">Data</a>
        </div>
    </div>
    <div>
        <h2 style="text-align: center;">Sales Analysis</h2>
        <table>
            
            <tr>
                <!-- Sales by Segment - Donut Chart -->
                <td><canvas id="sales_by_segment" class="chart-container" style="width: 350px; height: 350px;"></canvas></td>
                <!-- Sales by Region - Area Chart -->
                <td><canvas id="sales_by_region" class="chart-container" style="width: 375px; height: 350px;"></canvas></td>
                <!-- Sales by Ship Mode - Horizontal Bar Graph -->
                <td><canvas id="sales_by_category" class="chart-container" style="width: 450px; height: 350px;"></canvas></td>
            </tr>
            <tr>
                <!-- Profit by Segment - Donut Chart -->
                <td> <canvas id="profit_by_segment" class="chart-container" style="width: 350px; height: 350px;"></canvas></td>
                <!-- Profit by Region - Area Chart -->
                <td><canvas id="profit_by_region" class="chart-container" style="width: 375px; height: 350px;"></canvas></td>
                <!-- Sales by Sub-category - Horizontal Bar Graph -->
                <td><canvas id="sales_by_ship_mode" class="chart-container" style="width: 450px; height: 350px;"></canvas></td>
            </tr>
            
        </table>
    </div>

 

    <script>
        google.charts.load('current', { 'packages': ['corechart', 'bar'] });
        google.charts.setOnLoadCallback(drawCharts);

        function drawCharts() {
            drawSalesBySegment();
            drawSalesByRegion();
            drawSalesByCategory();
            drawProfitBySegment();
            drawProfitByRegion();
            drawSalesByShipMode();
        }


        //Sales by segment Donut Chart
        function calculateSales(data) {
            var salesMap = new Map();
            
            data.forEach(row => {
                var segment = row[6]; 
                var sales = parseInt(row[16]); 

                if (!salesMap.has(segment)) {
                    salesMap.set(segment, sales);
                } else {
                    salesMap.set(segment, salesMap.get(segment)+sales);
                }
            });

            var labels = Array.from(salesMap.keys());
            var salesCounts = Array.from(salesMap.values());

            return {
                labels: labels,
                salesCounts: salesCounts
            };
        }
        
        function drawSalesBySegment() {
            
            var dataFromFlask = {{ data | tojson }};
            var sales_by_segment = calculateSales(dataFromFlask);

            var ctx = document.getElementById('sales_by_segment').getContext('2d');
            var donutChart = new Chart(ctx, {
                type: 'doughnut', 
                data: {
                    labels: sales_by_segment.labels,
                    datasets: [{
                        label: 'Donut Chart',
                        data: sales_by_segment.salesCounts, 
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    plugins: {
                        colors: {
                            enabled: false
                        },
                        title: {
                            display: true,
                            text: 'Sales By Segment',
                            font: {
                                size: 16
                            }
                        }
                    }
                    
                }
            });
        }
        

        //Profit by Segment Donut chart

        function calculateProfits(data) {
            var salesMap = new Map();

            data.forEach(row => {
                var segment = row[6]; 
                var profits = parseInt(row[19]); 

                if (!salesMap.has(segment)) {
                    salesMap.set(segment, profits);
                } else {
                    salesMap.set(segment, salesMap.get(segment) + profits);
                }
            });

            var labels = Array.from(salesMap.keys());
            var salesCounts = Array.from(salesMap.values());

            return {
                labels: labels,
                salesCounts: salesCounts
            };
        }
        
        function drawProfitBySegment() {
            
            var dataFromFlask = {{ data | tojson }};
            var profits_by_segment = calculateProfits(dataFromFlask);

            var ctx = document.getElementById('profit_by_segment').getContext('2d');
            var donutChart = new Chart(ctx, {
                type: 'doughnut', 
                data: {
                    labels: profits_by_segment.labels,
                    datasets: [{
                        label: 'Donut Chart',
                        data: profits_by_segment.salesCounts, 
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    plugins: {
                        title: {
                            display: true,
                            text: 'Profit By Segment',
                            font: {
                                size: 16
                            }
                        }
                    }
                    
                }
            });
        }


        //sales by Region - Area chart
        function calculateSalesByRegion(data) {
            var salesMap = new Map();

            data.forEach(row => {
                var region = row[11]; 
                var sales = parseInt(row[16]); 

                if (!salesMap.has(region)) {
                    salesMap.set(region, sales);
                } else {
                    salesMap.set(region, salesMap.get(region) + sales);
                }
            });

            var labels = Array.from(salesMap.keys());
            var salesCounts = Array.from(salesMap.values());

            return {
                labels: labels,
                salesCounts: salesCounts
            };
            }

        function drawSalesByRegion() {
            var dataFromFlask = {{ data | tojson }};
            var salesByRegionData = calculateSalesByRegion(dataFromFlask);

            var ctx = document.getElementById('sales_by_region').getContext('2d');
            var salesByRegionChart = new Chart(ctx, {
                type: 'line', 
                data: {
                    labels: salesByRegionData.labels,
                    datasets: [{
                        label: 'Sales by Region',
                        data: salesByRegionData.salesCounts,
                        fill: true,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)', 
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Sales by Region',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 50 
                            }
                        },
                        x: {
                           
                        }
                    },
                   
                }
            });
        }

        //Sales by Category
        function calculateSalesByCat(data){
            var salesMap = new Map();

            data.forEach(row => {
                var Cat = row[13]; 
                var sales = parseInt(row[16]); 

                if (!salesMap.has(Cat)) {
                    salesMap.set(Cat, sales);
                } else {
                    salesMap.set(Cat, salesMap.get(Cat) + sales);
                }
            });

            var labels = Array.from(salesMap.keys());
            var salesCounts = Array.from(salesMap.values());

            return {
                labels: labels,
                salesCounts: salesCounts
            };

        }


        function drawSalesByCategory() {
            var dataFromFlask = {{ data | tojson }};
            var salesByCatData = calculateSalesByCat(dataFromFlask);

            var ctx = document.getElementById('sales_by_category').getContext('2d');
            var sales_by_Cat = new Chart(ctx, {
            type: 'bar', 
            data: {
                labels: salesByCatData.labels,
                datasets: [{
                    label: 'Category',
                    data: salesByCatData.salesCounts, 
                    backgroundColor: 'rgba(54, 162, 235, 0.7)', 
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y', 
                plugins: {
                    legend: {
                        position: 'right',
                        },
                    title: {
                        display: true,
                        text: 'Sales By Category',
                        font: {
                            size: 16
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true
                    },
                   
                }
                
            }
        });
        }

        //Profit by Region - Area chart
        function calculateProfitByRegion(data) {
            var salesMap = new Map();

            data.forEach(row => {
                var region = row[11]; 
                var profit = parseInt(row[19]); 

                if (!salesMap.has(region)) {
                    salesMap.set(region, profit);
                } else {
                    salesMap.set(region, salesMap.get(region) + profit);
                }
            });

            var labels = Array.from(salesMap.keys());
            var salesCounts = Array.from(salesMap.values());

            return {
                labels: labels,
                salesCounts: salesCounts
            };
            }

        function drawProfitByRegion() {
            var dataFromFlask = {{ data | tojson }};
            var profitsByRegionData = calculateProfitByRegion(dataFromFlask);

            var ctx = document.getElementById('profit_by_region').getContext('2d');
            var profitsByRegionChart = new Chart(ctx, {
                type: 'line', 
                data: {
                    labels: profitsByRegionData.labels,
                    datasets: [{
                        label: 'Profits by Region',
                        data: profitsByRegionData.salesCounts,
                        fill: true,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)', 
                        borderColor: 'rgba(75, 192, 192, 1)', 
                        borderWidth: 1
                    }]
                },
                options: {
                    maintainAspectRatio: false,
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Profits by Region',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 50 
                            }
                        },
                        x: {
                            
                        }
                    },
                    
                }
            });
        }

        //Sales by Ship Mode
        function calculateSalesByShipMode(data){
            var salesMap = new Map();

            data.forEach(row => {
                var shipmode = row[3]; 
                var sales = parseInt(row[16]); 

                if (!salesMap.has(shipmode)) {
                    salesMap.set(shipmode, sales);
                } else {
                    salesMap.set(shipmode, salesMap.get(shipmode) + sales);
                }
            });

            var labels = Array.from(salesMap.keys());
            var salesCounts = Array.from(salesMap.values());

            return {
                labels: labels,
                salesCounts: salesCounts
            };

        }

        function drawSalesByShipMode() {
            var dataFromFlask = {{ data | tojson }};
            var salesByShipModeData = calculateSalesByShipMode(dataFromFlask);

            var ctx = document.getElementById('sales_by_ship_mode').getContext('2d');
            var sales_by_Cat = new Chart(ctx, {
            type: 'bar', 
            data: {
                labels: salesByShipModeData.labels,
                datasets: [{
                    label: 'Ship Mode',
                    data: salesByShipModeData.salesCounts, 
                    backgroundColor: 'rgba(54, 162, 235, 0.7)',
                    borderColor: 'rgba(54, 162, 235, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                indexAxis: 'y', 
                plugins: {
                    legend: {
                        position: 'right',
                        },
                    title: {
                        display: true,
                        text: 'Sales By Ship Mode',
                        font: {
                            size: 16
                        }
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true
                    },
                    
                }
                
            }
        });
        }
    </script>
    
</body>
</html>
